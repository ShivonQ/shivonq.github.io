<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.11.3.min.js"></script>
    <link href="http://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel="stylesheet">
    <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
          integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
            integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
            crossorigin="anonymous"></script>
    <script src="https://maps.googleapis.com/maps/api/js?callback=initMap" async defer></script>
    <script type="text/javascript" src="javascript_files/settlement_class.js"></script>

    <script type="text/javascript" src="make_image_map_tiles.js"></script>
    <link rel="stylesheet" href="css/global_css.css">
    <meta charset="UTF-8">
    <div class="navbar-wrapper col-lg-12">
        <div class="row">

            <nav>
                <ul>
                    <li><a href="index.html" id="main_nav_link">Archaevas Wiki</a></li>
                    <li><a href="map_display_page.html">Map Page</a></li>
                    <li><a href="Calendar_Page.html">Calendar</a></li>
                    <li><a href="Major_Countries.html">Major Countries</a></li>
                </ul>
            </nav>
        </div>
    </div>
    <style>
        html, body {
            height: 400px;
            width: 600px;
            margin: 0;
            /*padding-top: 70px;*/
        }
    </style>
    <title>Archaevas Map</title>
</head>
<body class="container">
<div id="map_wrapper" style="position: relative">
    <div id="map" class="col-md-4" align="center">
    </div>
</div>
<div class="col-md-6">
    <!--TODO make this form have an action to push to DB-->
    <form id="admin_city_data_entry_form" enctype="application/json">
        <fieldset>
            <legend id="large_legend">Admin City Data Entry Form</legend>
            <div class="admin_wrapper">
                <table id="table_form_city_data">
                    <tr>
                        <td>City Name:</td>
                        <td><input type="text" id="city_name_box" name="city_name_box" size="25" maxlength="60"
                                   required="required"></td>
                        <td>Allegiance:</td>
                        <td><select name="allegiance_dropdown" required="required" id="allegiance_dropdown">
                            <option value="none"></option>
                            <option value="Scoia'tel">Scoia'tel</option>
                            <option value="Gjomatoughariil">Gjomatoughariil</option>
                            <option value="Thokklund">Thokklund</option>
                            <option value="Lochton">Lochton</option>
                            <option value="Denninhdane">Denninhdane</option>
                            <option value="Orsim">Orsim</option>
                            <option value="The Keep of The Wind">The Keep of The Winds</option>
                            <option value="The Golauchi Alliance">The Golauchi Alliance</option>
                            <option value="The Wilds">The Wilds</option>
                            <option value="Cavalcade">Cavalcade</option>
                            <option value="The Tumultuous Lands">The Tumultuous Lands</option>
                            <option value="The Endless Sands">The Endless Sands</option>
                        </select></td>
                    </tr>
                    <tr>
                        <td>City Population:</td><td><input type="text" id="city_pop_text_box" size="30" maxlength="30"></td>
                    </tr>
                    <tr>
                        <td>Latitude:</td>
                        <td><input type="text" id="lat_display" name="lat_display_box" size="9" maxlength="15"
                                   required="required"></td>
                        <td>Longitude:</td>
                        <td><input type="text" id="lng_display" name="lng_display_box" size="9" maxlength="15"
                                   required="required"></td>
                    </tr>
                    <tr>
                        <td>Governement Type:</td>
                        <td><select id="gov_type_dropdown" name="gov_type_dropdown" required="required">
                            <option value="none"></option>
                            <option value="Magocracy">Magocracy</option>
                            <option value="Elected Council">Elected Council</option>
                            <option value="Monarchy">Monarchy</option>
                            <option value="Theocracy">Theocracy</option>
                            <option value="Commonwealth">Commonwealth</option>
                            <option value="Dictatorship">Dictatorship</option>
                            <option value="Plutocracy">Plutocracy</option>
                            <option value="Meritocracy">Meritocracy</option>
                            <option value="Oligarchy">Oligarchy</option>
                            <option value="Socialist">Socialist</option>
                            <option value="Totalitarian">Totalitarian</option>
                            <option value="Theocratic-Monarchy">Theocratic-Monarchy</option>
                            <option value="Theocratic-Meritocracy">Theocratic-Meritocracy</option>

                        </select></td>
                        <td>Alignment:</td>
                        <td><select id="alignment_dropdown" name="alignement_dropdown" required="required">
                            <option value="none"></option>
                            <option value="Lawful Good">Lawful Good</option>
                            <option value="Neutral Good">Neutral Good</option>
                            <option value="Chaotic Good">Chaotic Good</option>
                            <option value="Lawful Neutral">Lawful Neutral</option>
                            <option value="Neutral Neutral">Neutral Neutral</option>
                            <option value="Chaotic Neutra">Chaotic Neutral</option>
                            <option value="Lawful Evil">Lawful Evil</option>
                            <option value="Neutral Evil">Neutral Evil</option>
                            <option value="Chaotic Evil">Chaotic Evil</option>
                        </select></td>

                    </tr>
                    <tr>
                        <td align="left" colspan="2">
                            <fieldset class="small_inner_fieldset">
                                <div id="gov_npcs_div"></div>
                                <legend class="smaller_legend">Add Government NPCs</legend>
                                <input type="button" value="Add Another NPC" class="add_gov" id="add_gov_npc_button">
                            </fieldset>
                        </td>
                        <td colspan="2"><textarea id="city_description" required="required" maxlength="300">Please enter the city's description.</textarea>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4">
                            <hr class="form_divider">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4" id="shops_banner" align="center">Shops in Town</td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <fieldset class="small_inner_fieldset">
                                <div id="general_stores_div"></div>
                                <legend class="smaller_legend">General</legend>
                                <input type="button" value="Add Another Shop" class="add_general"
                                       id="add_general_store_button">
                            </fieldset>
                        </td>
                        <td colspan="2">
                            <fieldset class="small_inner_fieldset">
                                <div id="taverns_div"></div>
                                <legend class="smaller_legend">Taverns & Others</legend>
                                <input type="button" value="Add Another Shop" class="add_tavern" id="add_tavern_button">
                            </fieldset>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <fieldset class="small_inner_fieldset">
                                <div id="weps_and_armor_div"></div>
                                <legend class="smaller_legend">Weapons and Armor</legend>
                                <input type="button" value="Add Another Shop" class="add_weps"
                                       id="add_weps_and_armor_button">
                            </fieldset>
                        </td>
                        <td colspan="2">
                            <fieldset class="small_inner_fieldset">
                                <div id="magic_shops_div"></div>
                                <legend class="smaller_legend">Magic Items</legend>
                                <input type="button" value="Add Another Shop" class="add_magic"
                                       id="add_magic_store_button">
                            </fieldset>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4">
                            <hr class="form_divider">
                        </td>
                    </tr>
                    <tr>
                        <td>Sheriff or Captain</td>
                        <td><select id="captain_selector">
                            <option value="none"></option>
                            <option value="Sheriff">Sheriff</option>
                            <option value="Captain">Captain</option>
                        </select></td>
                        <td colspan="2"><input type="text" id="guard_captain" size="30" maxlength="40"></td>
                    </tr>
                    <tr>
                        <td colspan="4">
                            <fieldset>
                                <div id="spellcasters_div"></div>
                                <legend class="smaller_legend">Notable Spellcasters</legend>
                                <input type="button" value="Add Spellcaster" class="add_caster"
                                       id="add_spellcaster_button" size="20" maxlength="30">
                            </fieldset>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <fieldset class="small_inner_fieldset">
                                <div id="major_exports_div"></div>
                                <legend class="smaller_legend">Major Exports</legend>
                                <input type="button" value="Add Export" class="add_export" id="add_export_button">
                            </fieldset>
                        </td>
                        <td colspan="2">
                            <fieldset class="small_inner_fieldset">
                                <div id="major_imports_div"></div>
                                <legend class="smaller_legend">Major Exports</legend>
                                <input type="button" value="Add Import" class="add_import" id="add_import_button">
                            </fieldset>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4">
                            Upload an city map: <input type="file" name="city_map"/><br/>
                        </td>

                    </tr>
                    <tr>
                        <td colspan="4"><button id="submit_form_button">Save This City's Data:       <span class="glyphicon glyphicon-floppy-save"></span></button></td>
                    </tr>
                </table>
            </div>
        </fieldset>
    </form>
</div>
</body>
<script>
    $(document).ready(function () {
//        $("#large_legend").on("click",function(){
//            var $this=$(this);
//            var parent=$this.parent();
//            var contents=parent.contents().not(this);
//            if(contents.length>0){
//                $this.data("contents",contents.remove());
//            } else if (contents.length==0){
//                $this.data("contents",appendTo(parent));
//            }
//        });
//
        $("#submit_form_button").on("click",function(){
            json_city_maker()
        });
//        TODO: Alas, I never was able to get this to work.  My selectors arent seelecting the items that get created.  It is because they aren't there when the doc.ready runs
//       The rest of this stuff works.
        function json_city_maker(){
            var cityname=$("#city_name_box").val();
            var allegiance=$("#allegiance_dropdown option:selected").text();
            var city_pop=$("#city_pop_text_box").val();
            var lat=$("#lat_display").val();
            var lng=$("#lng_display").val();
            var gov_type=$("#gov_type_dropdown option:selected").text();
            var gov_align=$("#alignment_dropdown option:selected").text();
            var city_desc=$("#city_description").val();

            var all_gov_npcs=$("#gov_npc").val();
            var sheriff_or_captain=$("#captain_selector option:selected").text();
            var name_of_s_or_c=$("#guard_captain").val();
            var combo_of_above=sheriff_or_captain+" "+name_of_s_or_c;
//            lists and lists of items
            var spellcasters=$("#caster").val();
            var all_authority_figures={"Governmental":[all_gov_npcs],"Guard Captain":[combo_of_above],"Notable Spellcasters":[spellcasters]}

            var gen_shops=$("#general_store").val();
            var taverns_shops=$("#tavern_or_other").val();
            var magic_item_shops=$("#magic_item_shop").val();
            var weps_and_armor=$("#wep_armor_shop").val();
            var collection_of_stores={"General Stores":[gen_shops],"Weapons & Armor":[weps_and_armor],"Magic Items":[magic_item_shops],"Other Vendors":[taverns_shops]}

            var maj_imp=$("#import").val();
            var maj_exp=$("#export").val();

            var new_city_data=new Settlement_Data(parseInt(city_pop));
            new_city_data.name=cityname;
            new_city_data.country_or_area=allegiance;
            new_city_data.latitude=lat;
            new_city_data.longitude=lng;
            new_city_data.power_center_in_community=gov_type;
            new_city_data.power_center_alignement=gov_align;
            new_city_data.authority_figures=all_authority_figures;
            new_city_data.local_stores=collection_of_stores;
            new_city_data.major_imports=maj_imp;
            new_city_data.major_exports=maj_exp;
            new_city_data.general_description_of_settlement=city_desc;

        }
        $("#large_legend").on("click", function () {
            $(this).parent().find('.admin_wrapper').slideToggle("slow");
        });

        $("#add_spellcaster_button").on("click", function () {
            var all_casters = $("<div class=\"all_casters\" class=\"casters\"/>");
            var caster_text_field = $("<input type=\"text\" class=\"caster\"/>");
            var remove_caster_button = $("<button  class=\"remove_caster_button\"><span class=\"glyphicon glyphicon-minus\"></span></button>");
            var select_caster_type = $("<select><option value='none'></option><option value='Arcane'>Arcane</option><option value='Divine'>Divine</option>")
            remove_caster_button.click(function () {
                $(this).parent().remove();
            });
            all_casters.append(select_caster_type);
            all_casters.append(caster_text_field);
            all_casters.append(remove_caster_button);
            $("#spellcasters_div").append(all_casters);
        });
        $("#add_import_button").on("click", function () {
            var all_imports = $("<div class=\"all_imports\" class=\"imports\"/>");
            var import_text_field = $("<input type=\"text\" class=\"import\"/>");
            var remove_import_button = $("<button  class=\"remove_import_button\"><span class=\"glyphicon glyphicon-minus\"></span></button>");
            remove_import_button.click(function () {
                $(this).parent().remove();
            });
            all_imports.append(import_text_field);
            all_imports.append(remove_import_button);
            $("#major_imports_div").append(all_imports);
        });
        $("#add_export_button").on("click", function () {
            var all_exports = $("<div class=\"all_exports\" class=\"exports\"/>");
            var export_text_field = $("<input type=\"text\" class=\"export\"/>");
            var remove_export_button = $("<button  class=\"remove_export_button\"><span class=\"glyphicon glyphicon-minus\"></span></button>");
            remove_export_button.click(function () {
                $(this).parent().remove();
            });
            all_exports.append(export_text_field);
            all_exports.append(remove_export_button);
            $("#major_exports_div").append(all_exports);
        });
        $("#add_gov_npc_button").on("click", function () {
            var all_gov_npcs = $("<div class=\"all_gov_npcs\" class=\"gov_npcs\"/>");
            var npc_text_field = $("<input type=\"text\" class=\"gov_npc\"/>");
            var remove_gov_button = $("<button  class=\"remove_gov_button\"><span class=\"glyphicon glyphicon-minus\"></span></button>");
            remove_gov_button.click(function () {
                $(this).parent().remove();
            });
            all_gov_npcs.append(npc_text_field);
            all_gov_npcs.append(remove_gov_button);
            $("#gov_npcs_div").append(all_gov_npcs);
        });
        $("#add_general_store_button").on("click", function () {
            var all_general_stores = $("<div class=\"all_general_stores\" class=\"general_stores\"/>");
            var store_text_field = $("<input type=\"text\" class=\"general_store\"/>");
            var remove_gen_store_button = $("<button  class=\"remove_gen_store_button\"><span class=\"glyphicon glyphicon-minus\"></span></button>");
            remove_gen_store_button.click(function () {
                $(this).parent().remove();
            });
            all_general_stores.append(store_text_field);
            all_general_stores.append(remove_gen_store_button);
            $("#general_stores_div").append(all_general_stores);
        });
        $("#add_tavern_button").on("click", function () {
            var all_taverns_and_otheras = $("<div class=\"all_taverns_and_others\" class=\"taverns_and_others\"/>");
            var store_text_field = $("<input type=\"text\" class=\"tavern_or_other\"/>");
            var remove_tavern_button = $("<button  class=\"remove_tavern_button\"><span class=\"glyphicon glyphicon-minus\"></span></button>");
            remove_tavern_button.click(function () {
                $(this).parent().remove();
            });
            all_taverns_and_otheras.append(store_text_field);
            all_taverns_and_otheras.append(remove_tavern_button);
            $("#taverns_div").append(all_taverns_and_otheras);
        });
        $("#add_weps_and_armor_button").on("click", function () {
            var all_weps_and_armor = $("<div class=\"all_weps_and_armor\" class=\"weps_and_armor\"/>");
            var store_text_field = $("<input type=\"text\" class=\"wep_armor_shop\"/>");
            var remove_weps_button = $("<button  class=\"remove_weps_button\"><span class=\"glyphicon glyphicon-minus\"></span></button>");
            remove_weps_button.click(function () {
                $(this).parent().remove();
            });
            all_weps_and_armor.append(store_text_field);
            all_weps_and_armor.append(remove_weps_button);
            $("#weps_and_armor_div").append(all_weps_and_armor);
        });
        $("#add_magic_store_button").on("click", function () {
            var all_magic = $("<div class=\"all_magic_items\" class=\"magic_items\"/>");
            var store_text_field = $("<input type=\"text\" class=\"magic_item_shop\"/>");
            var remove_magic_button = $("<button  class=\"remove_magic_button\"><span class=\"glyphicon glyphicon-minus\"></span></button>");
            remove_magic_button.click(function () {
                $(this).parent().remove();
            });
            all_magic.append(store_text_field);
            all_magic.append(remove_magic_button);
            $("#magic_shops_div").append(all_magic);
        });
    });
</script>
</html>